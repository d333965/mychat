import{r as l,o as h,c as g,a as e,w as a,b as m,E as b,d as v,u as f,e as E,f as P,g as A,t as B,h as M,n as C,_ as S,F,i as V,j as $,v as N,k as R,T as K,l as j}from"./index-Cm_0E-Bg.js";import{_ as z,u as D,a as H,b as T,s as O,h as U}from"./footbar-VxT5O6bc.js";const q={class:"user-container"},G=["innerHTML"],J=m("img",{src:z,alt:"user",class:"userImg"},null,-1),Q={__name:"user",props:{content:String},setup(r){const o=r,c=()=>{const n=document.createElement("textarea"),t=document.createElement("div");t.innerHTML=o.content,n.value=t.textContent||t.innerText||"",document.body.appendChild(n),n.select();try{document.execCommand("copy"),b.success("复制成功")}catch{b.error("复制失败")}document.body.removeChild(n)};return(n,t)=>{const i=l("el-card");return h(),g("div",q,[e(i,{class:"userCard",onClick:c},{default:a(()=>[m("p",{innerHTML:r.content,class:"markdown-body"},null,8,G)]),_:1}),J])}}},W={class:"assistant-container"},X=["src"],Y=["innerHTML"],Z={style:{margin:"0"}},k={__name:"assistant",props:{content:String,index:Number},emits:["deleteMessage"],setup(r,{emit:o}){const c=D(),n=r,t=v(!1),i=v(null),s=()=>{const _=i.value.innerText||i.value.textContent,p=document.createElement("textarea");p.value=_,document.body.appendChild(p),p.select();try{document.execCommand("copy"),t.value=!0,setTimeout(()=>{t.value=!1},2e3)}catch(y){console.error("复制失败",y)}document.body.removeChild(p)},d=o,u=()=>{d("deleteMessage",n.index)};return(_,p)=>{const y=l("Delete"),x=l("el-icon"),w=l("MoreFilled"),I=l("el-popover"),L=l("el-card");return h(),g("div",W,[m("img",{src:f(c).AIphoto,alt:"assistant",class:"assistantImg"},null,8,X),e(L,{class:"assistantCard"},{default:a(()=>[m("p",{ref_key:"contentRef",ref:i,innerHTML:r.content,class:"markdown-body"},null,8,Y),e(I,{placement:"right-end",trigger:"click","popper-class":"custom-popover"},{reference:a(()=>[e(x,{class:"MoreFilled"},{default:a(()=>[e(w)]),_:1})]),default:a(()=>[m("div",Z,[m("p",{class:"custom-p",onClick:u},[e(x,{style:{width:"20px",margin:"6px"}},{default:a(()=>[e(y)]),_:1}),E(" 删除 ")]),m("p",{class:"custom-p",onClick:s},[e(x,{style:{width:"20px",margin:"6px"}},{default:a(()=>[(h(),P(A(t.value?"DocumentChecked":"DocumentCopy")))]),_:1}),m("span",null,B(t.value?"已复制":"复制"),1)])])]),_:1})]),_:1})])}}};function ee(){const r=v(null);let o=!0;const c=()=>{const t=r.value;t.scrollTop=t.scrollHeight-t.clientHeight},n=()=>{const t=r.value;t.scrollHeight-t.clientHeight-5<=t.scrollTop?o=!0:o=!1};return M(()=>{const t=r.value;new MutationObserver(()=>{o&&C(()=>{c()})}).observe(t,{childList:!0,subtree:!0}),C(()=>{c()})}),{chatContainer:r,handleScroll:n}}const te={__name:"mainPart",setup(r){const{chatContainer:o,handleScroll:c}=ee(),n=D(),t=H(),i=s=>{t.messageList.splice(s,1)};return(s,d)=>(h(),g("div",{class:"chat-container",ref_key:"chatContainer",ref:o,onScroll:d[0]||(d[0]=(...u)=>f(c)&&f(c)(...u))},[e(k,{content:f(n).prologue},null,8,["content"]),(h(!0),g(F,null,V(f(t).messageList,(u,_)=>(h(),g("div",{key:_},[e(Q,{content:u.user},null,8,["content"]),e(k,{content:u.assistant,index:_,onDeleteMessage:i},null,8,["content","index"])]))),128))],544))}},ne=S(te,[["__scopeId","data-v-51cb003c"]]),oe={class:"input-container"},se=["disabled"],ae={__name:"inputbar",setup(r){const o=v(null),c=()=>{const s=o.value;s.style.height="40px",s.style.height=`${s.scrollHeight}px`};M(()=>{c()});const n=H(),t=s=>{if(s.keyCode===13&&!s.shiftKey){s.preventDefault(),n.sendMessage();const d=o.value;d.style.height="40px"}},i=()=>{n.sendMessage();const s=o.value;s.style.height="40px"};return(s,d)=>{const u=l("Promotion"),_=l("el-icon"),p=l("Paperclip");return h(),g("div",oe,[$(m("textarea",{placeholder:"请输入问题",class:"inputstyle",onInput:c,ref_key:"textarea",ref:o,"onUpdate:modelValue":d[0]||(d[0]=y=>f(n).user=y),onKeyup:R(t,["enter"])},null,544),[[N,f(n).user]]),m("button",{class:"send-button",onClick:i,disabled:f(n).loading},[e(_,{style:{"font-size":"20px",margin:"0"}},{default:a(()=>[e(u)]),_:1})],8,se),e(_,{class:"Paperclip"},{default:a(()=>[e(p)]),_:1})])}}},ce=S(ae,[["__scopeId","data-v-f0563944"]]),le={class:"common-layout"},de={__name:"home",setup(r){const o=v(!1),c=v(null);function n(){o.value=!o.value}return(t,i)=>{const s=l("el-aside"),d=l("el-header"),u=l("el-main"),_=l("el-footer"),p=l("el-container");return h(),g("div",le,[e(p,null,{default:a(()=>[e(s,{class:"menu"},{default:a(()=>[e(T)]),_:1}),e(K,{name:"slide-fade"},{default:a(()=>[$(e(s,{class:"sidebar",ref_key:"sidebarRef",ref:c},{default:a(()=>[e(O,{onToggleSidebar:n})]),_:1},512),[[j,o.value]])]),_:1}),e(p,null,{default:a(()=>[e(d,{class:"headbar"},{default:a(()=>[e(U,{onToggleSidebar:n})]),_:1}),e(u,{class:"mainPart"},{default:a(()=>[e(ne)]),_:1}),e(ce),e(_,{class:"footbar"},{default:a(()=>[e(T)]),_:1})]),_:1})]),_:1})])}}};export{de as default};
